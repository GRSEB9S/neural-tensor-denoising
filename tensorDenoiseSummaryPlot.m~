function tensorDenoiseSummaryPlot(summary_in, Ytrue, Ys_)

options = struct;
options.threshold = 0;

for rr = 1:length(summary_in(1).summary.errs)
  Ytr = mean(Ys_(:,:,:,1:rr), 4, 'omitnan');
  errTrue = tensorDenoiseERR( Ytrue, Ytr, options);
  errDN  = tensorDenoiseERR( Ytrue, tensorDenoiseSVD(Ytr, summary_in(1).summary.minrank(rr,:)), options);
  errDN1 = tensorDenoiseERR( Ytrue, tensorDenoiseSVD(Ytr, summary_in(2).summary.minrank(rr,:)), options);
  errDN2 = tensorDenoiseERR( Ytrue, tensorDenoiseSVD(Ytr, summary_in(3).summary.minrank(rr,:)), options);
  errDN3 = tensorDenoiseERR( Ytrue, tensorDenoiseSVD(Ytr, summary_in(4).summary.minrank(rr,:)), options);
  errFilt = tensorDenoiseERR( Ytrue, filterGauss(Ytr, summary_in(5).summary.minfilt(rr), 2), options); 
  
  vaf(rr,1) = errTrue.vaf;
  vaf(rr,2) = errDN.vaf;
  vaf(rr,3) = errDN1.vaf;
  vaf(rr,4) = errDN2.vaf;
  vaf(rr,5) = errDN3.vaf;
  vaf(rr,6) = errFilt.vaf;
end

figure; hold all
xaxis = 2:length(summary_in(1).summary.errs)+1;
plot(xaxis,vaf)
legend('average','tensor','neuron','time','condition','filter');
xlabel('trials (per neuron per condition)');
ylabel('1 - VAF, relative to "ground truth" data');

figure; hold all
plot(xaxis,real(1).summary.minrank);
plot([xaxis(1) xaxis(end)],[DataSim.size_core; DataSim.size_core],'--');
legend('neuron','time','condition');
title('optimal multilinear rank | tensor denoising');
figure; hold all
plot(xaxis,real(2).summary.minrank(:,1));
plot(xaxis,real(3).summary.minrank(:,2));
plot(xaxis,real(4).summary.minrank(:,3));
legend('neuron','time','condition');
title('optimal ranks | matrix denoising')
figure; hold all
plot(xaxis,real(5).summary.minfilt);
legend('filter width');
title('optimal filter width | filter denoising');
  

end
